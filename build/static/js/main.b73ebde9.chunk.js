(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){e.exports=a.p+"static/media/logo.21f34708.png"},29:function(e,t,a){e.exports=a.p+"static/media/logo.bb973869.svg"},32:function(e,t,a){e.exports=a(54)},42:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(25),i=a.n(o),s=a(2),l=a(3),c=a(5),u=a(4),d=a(6),p=a(9),m=a(57),h=a(17),f=a(27),b=a(11),v=a(7),y="actions:dataSources:toggle",g="actions:dataSources:loadData",E="actions:dataSources:merge";function O(e){var t=0;for(var a in e)e[a].enabled&&(t+=1);return t}var j={sqlEditor:{height:200,options:{value:"",language:"sql",lineNumbers:"off",scrollBeyondLastLine:!1,automaticLayout:!0,emptySelectionClipboard:!1,folding:!0,fontFamily:"Menlo, monospace",fontSize:13,glyphMargin:!0,lineHeight:16,mouseWheelZoom:!0,renderLineHighlight:"all",minimap:{enabled:!0,renderCharacters:!1}}}},N="actions:ui:sql-editor:setHeight";var w=window,k=w.location,S=w.fetch,x=new URL("".concat(k.protocol,"//").concat(k.hostname,":3003"));function M(e,t){var a=new URL(e,x);return S(a,Object(v.a)({mode:"cors",credentials:"include"},t)).then(function(e){return e.json()}).then(function(e){if(e.error)throw new Error(e.error);return e})}var C={login:function(e,t){var a=new URLSearchParams;return a.set("username",e),a.set("password",t),M("auth/login",{method:"POST",body:a})},logout:function(){return M("auth/logout")},query:function(e){var t=new URLSearchParams;return t.append("query",e),M("sql",{method:"POST",body:t})},request:M},D=window.jQuery,A={loading:!1,error:null,currentUser:JSON.parse(sessionStorage.currentUser||"null")},q="actions:auth:merge",R="actions:auth:setLoading";function U(e){return{type:R,payload:e}}function z(e){return{type:q,payload:e}}var I="actions:organization:toggle",L="actions:organization:loadData";var Y="actions:measures:loadData";var P="actions:payers:toggle",T="actions:payers:loadData";function H(e){return function(t,a){var r=a().payers[e],n=r.ds_id;r.selected||t(function(e){return function(t,a){var r=a(),n=Object(v.a)({},r.dataSources);for(var o in n)"claims"===n[o].type&&(n[o].selected=o===e);t({type:E,payload:n})}}(n)),t({type:P,payload:e})}}var F={loading:!1,error:null,data:null,uri:""},_="actions:measureResults:setLoading",W="actions:measureResults:setError",B="actions:measureResults:setData",V="actions:measureResults:merge";function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,a){var r=a(),n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.org,r=t.payer,n=(t.clinic,t.ds),o=new URLSearchParams;return r?o.append("payer",r):Object.keys(e.payers).map(function(t){return e.payers[t].selected&&o.append("payer",t),!0}),a?o.append("org",a):Object.keys(e.organizations).map(function(t){return e.organizations[t].enabled&&o.append("org",t),!0}),n?o.append("ds",n):Object.keys(e.dataSources).map(function(t){return e.dataSources[t].selected&&o.append("ds",t),!0}),o.has("payer")&&o.has("ds")&&(o=o.toString())?"/api/measure/result?"+o:null}(r,e);n&&n!==r.uri&&(t(J({uri:n,loading:!0})),C.request(n).then(function(e){return t(J({data:e,loading:!1}))},function(e){return t(J({error:e,loading:!1}))}))}}function J(e){return{type:V,payload:e}}var G=[f.a],Z=Object(h.d)(Object(h.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return D.extend(!0,{},e,t.payload);case R:return Object(v.a)({},e,{loading:!!t.payload});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(v.a)({},e,{sqlEditor:Object(v.a)({},e.sqlEditor,{height:t.payload})});default:return e}},organizations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(v.a)({},e,Object(b.a)({},t.payload,Object(v.a)({},e[t.payload],{enabled:!e[t.payload].enabled})));case L:var a={};return t.payload.forEach(function(e){a[e.id]=e}),a;default:return e}},dataSources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return O(e)<=1&&e[t.payload].selected?e:Object(v.a)({},e,Object(b.a)({},t.payload,Object(v.a)({},e[t.payload],{selected:!e[t.payload].selected})));case g:return Object(v.a)({},t.payload);case E:return window.jQuery.extend(!0,e,t.payload);default:return e}},measures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:var a={};return t.payload.forEach(function(e){a[e.id]=e}),a;default:return e}},payers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:var a={};for(var r in e)a[r]=Object(v.a)({},e[r],{selected:r===t.payload&&!e[t.payload].selected});return a;case T:var n={};return t.payload.forEach(function(e){n[e.id]=e}),n;default:return e}},measureResults:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(v.a)({},e,{loading:!!t.payload});case W:return Object(v.a)({},e,{error:t.payload});case B:return Object(v.a)({},e,{data:t.payload});case V:return Object(v.a)({},e,t.payload);default:return e}}}),h.a.apply(void 0,G)),K=Z;C.request("api/ui").then(function(e){Z.dispatch(function(e){return{type:L,payload:e}}(e.organizations)),Z.dispatch(function(e){return function(t){t({type:T,payload:e})}}(e.payers)),Z.dispatch(function(e){return{type:Y,payload:e}}(e.measures)),Z.dispatch(function(e){return function(t,a){var r=a(),n={};e.forEach(function(e){var t=!!e.enabled,a=!!e.selected;if("claims"===e.type){t=!1;var o=Object.keys(r.payers).find(function(t){return r.payers[t].ds_id===e.id});o&&!r.payers[o].selected||(a=!0)}n[e.id]=Object(v.a)({},e,{selected:a,enabled:t})}),t({type:g,payload:n})}}(e.dataSources))});var X=a(31),$=a(30),ee=a(58),te=a(56),ae=a(28),re=a.n(ae),ne=(a(42),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("header",{className:"app-header navbar navbar-expand-lg"},n.a.createElement("div",{className:"container collapse navbar-collapse justify-content-between"},n.a.createElement("div",{className:"navbar-brand"},n.a.createElement(te.a,{className:"app-link",to:"/measures"},n.a.createElement("img",{src:re.a,className:"app-logo",alt:"logo"}))),this.props.user&&n.a.createElement(n.a.Fragment,null,n.a.createElement("ul",{className:"navbar-nav justify-content-center"},n.a.createElement($.a,{path:"/measures",render:function(){return n.a.createElement("li",{className:"nav-item"},n.a.createElement("b",{className:"nav-link active"},"Measures"))}}),n.a.createElement($.a,{path:"/report",render:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"nav-item"},n.a.createElement(te.a,{className:"nav-link",to:"/measures"},"Measures")),n.a.createElement("li",{className:"nav-item"},n.a.createElement("b",{className:"nav-link active"},"Report")))}})),n.a.createElement("ul",{className:"navbar-nav"},n.a.createElement("li",{className:"nav-item text-right"},n.a.createElement("a",{className:"nav-link",onClick:function(t){t.preventDefault(),e.props.dispatch(function(e,t){return e(U(!0)),C.logout().then(function(){sessionStorage.removeItem("currentUser"),e(z({currentUser:null,error:null,loading:!1}))})})},href:"/login"},n.a.createElement("i",{className:"fas fa-power-off"+(this.props.loading?" fa-spin":""),style:{color:"#FA0"}})," Logout"))))))}}]),t}(n.a.Component)),oe=(a(44),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.radio?this.props.checked?"fa fa-check-circle":"far fa-circle":this.props.checked?"fas fa-check-square":"far fa-square";return n.a.createElement("label",{className:"checkbox-label"+(this.props.checked?" selected":""),onClick:function(){return!e.props.disabled&&e.props.onChange(!e.props.checked)},disabled:!!this.props.disabled},n.a.createElement("i",{className:t})," ",this.props.label)}}]),t}(n.a.Component)),ie=(a(45),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[],a=[],r=function(r){var o=e.props.dataSources[r],i=n.a.createElement(oe,{key:r,label:o.label,checked:!!o.selected,disabled:!o.enabled,onChange:function(){return e.props.toggleDataSource(r)},radio:"claims"===o.type});"ehr"===o.type?t.push(i):"claims"===o.type&&a.push(i)};for(var o in this.props.dataSources)r(o);return n.a.createElement("div",null,n.a.createElement("h6",{className:"data-sources-title"},"EHR DATA SOURCES"),t,n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("h6",{className:"data-sources-title"},"CLAIMS DATA SOURCE"),a)}}]),t}(n.a.Component)),se=Object(p.b)(function(e){return{dataSources:Object(v.a)({},e.dataSources)}},function(e){return{toggleDataSource:function(t){return e(function(e){return{type:y,payload:e}}(t))}}})(ie),le=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"col-3 app-sidebar"},n.a.createElement(se,null))}}]),t}(n.a.Component);a(46);window.require.config({paths:{vs:"/monaco-editor/min/vs"}});var ce=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillUnmount",value:function(){this.editor&&(this.editor.dispose(),this.editor=null)}},{key:"componentDidMount",value:function(){var e=this;window.require(["vs/editor/editor.main"],function(t){if(e.editorNode){e.editor=t.editor.create(e.editorNode,Object(v.a)({},e.props.options,{value:e.props.query}));var a=window.jQuery,r=a(window),n=a(e.editorNode);a(e.divider).on("mousedown",function(t){var a=t.clientY,o=n.css({overflow:"hidden"}).height();r.on("mouseup.resize",function(){n.css({overflow:"visible"}),e.props.onHeightChange(n.outerHeight()),r.off(".resize")}),r.on("mousemove.resize",function(e){n.height(o+e.clientY-a)})})}})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"sql-editor",ref:function(t){return e.editorNode=t},style:{height:this.props.height}}),n.a.createElement("div",{className:"sql-editor-resizer",ref:function(t){return e.divider=t}},"....."),n.a.createElement("button",{className:"btn btn-brand active",onClick:function(){return e.props.onQuery(e.editor.getValue())}},"RUN"))}}]),t}(n.a.Component);ce.defaultProps={query:""};a(47);var ue=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"buildCsvUrl",value:function(){return"http://localhost:3003/sql/csv?q="+btoa(this.props.query)}},{key:"render",value:function(){var e=this.props.data,t=void 0===e?{}:e;return n.a.createElement("div",{className:"table-wrap"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 align-middle"},n.a.createElement("h5",null,"Preview")),n.a.createElement("div",{className:"col-6 text-right"},n.a.createElement("a",{className:"btn btn-brand",href:this.buildCsvUrl(),download:"report.csv"},"DOWNLOAD CSV"))),n.a.createElement(de,{cols:t.header,rows:t.data}))}}]),t}(n.a.Component),de=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this))).wrapper=n.a.createRef(),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.syncHeader()}},{key:"componentDidMount",value:function(){this.syncHeader()}},{key:"syncHeader",value:function(){if(this.wrapper.current){var e=this.wrapper.current.querySelectorAll(".data-grid-header th");this.wrapper.current.querySelectorAll(".data-grid-body tr:first-child td").forEach(function(t,a){e[a].style.width=Math.floor(t.clientWidth+1)+"px"})}}},{key:"render",value:function(){var e=this.props,t=e.rows,a=e.cols;if(!t.length)return n.a.createElement("p",{className:"text-center"},"No data");var r=n.a.createElement("thead",null,n.a.createElement("tr",null,a.map(function(e,t){return n.a.createElement("th",{key:"th-"+t,title:e},e)}))),o=t.map(function(e,t){return n.a.createElement("tr",{key:t,tabIndex:0},e.map(function(e,a){return n.a.createElement("td",{key:"cell-"+t+"-"+a},e)}))});return n.a.createElement("div",{ref:this.wrapper},n.a.createElement("div",{className:"data-grid-header"},n.a.createElement("table",{className:"table table-sm table-bordered table-hover data-grid"},r)),n.a.createElement("div",{className:"data-grid-body"},n.a.createElement("table",{className:"table table-sm table-bordered table-hover data-grid"},n.a.createElement("tbody",null,o))))}}]),t}(n.a.Component);de.defaultProps={cols:[],rows:[]};var pe=a(8),me=a.n(pe),he=a(19);a(49);var fe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={numerator:0,denominator:1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({animating:!0},function(){window.jQuery({numerator:0,denominator:e.props.denominator}).animate({numerator:e.props.numerator,denominator:e.props.denominator},{duration:e.props.duration,easing:e.props.easing,step:function(t,a){return e.setState(Object(b.a)({},a.prop,t))},complete:function(){return e.setState({animating:!1})}})})}},{key:"componentDidUpdate",value:function(){var e=this;this.state.animating||this.state.numerator===this.props.numerator||this.setState({animating:!0},function(){window.jQuery({numerator:e.state.numerator,denominator:e.state.denominator}).animate({numerator:e.props.numerator,denominator:e.props.denominator},{duration:e.props.duration,easing:e.props.easing,step:function(t,a){return e.setState(Object(b.a)({},a.prop,t))},complete:function(){return e.setState({animating:!1})}})})}},{key:"render",value:function(){var e=Math.max(Math.min(this.state.numerator/this.state.denominator*100,100),0),t=e>=50?1:0,a=function(e){return[100*Math.cos(2*Math.PI*e),100*Math.sin(2*Math.PI*e)]}(e/100),r=Object(he.a)(a,2),o=r[0],i=r[1];return n.a.createElement("svg",{className:"chart",viewBox:"-110 -110 220 220"},n.a.createElement("text",{className:"chart-big-text",y:0},Math.round(e),"%"),n.a.createElement("text",{className:"chart-small-text",y:35},Math.round(this.state.numerator),"/",Math.round(this.state.denominator)),0===e?n.a.createElement("circle",{cx:0,cy:0,r:100,className:"chart-arc-bg"}):n.a.createElement("g",{style:{transform:"rotate(-0.25turn)"}},n.a.createElement("path",{className:"chart-arc-main",d:"M 100 0 A 100 100 0 ".concat(t," 1 ").concat(o," ").concat(i)}),n.a.createElement("path",{className:"chart-arc-bg",d:"M ".concat(o," ").concat(i," A 100 100 0 ").concat(t?0:1," 1 100 0")})))}}]),t}(n.a.Component);fe.defaultProps={duration:1200,easing:"easeInOutExpo"};a(50);var be=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.date,a=e.clinic,r=e.measureName,o=e.numeratorValue,i=e.denominatorValue,s=e.measureDescription,l=e.numeratorDescription,c=e.denominatorDescription;return n.a.createElement("div",{className:"report-summary"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-8"},n.a.createElement("div",{className:"sub-title"},a,": ",me()(t).format("MMMM YYYY")),n.a.createElement("div",{className:"title"},r)),n.a.createElement("div",{className:"col"},n.a.createElement(fe,{numerator:o,denominator:i}))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col"},n.a.createElement("p",{className:"sub-title"},"POPULATION HEALTH IMPACT"),n.a.createElement("p",null,s))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col"},n.a.createElement("p",{className:"sub-title"},"NUMERATOR"),n.a.createElement("p",null,l)),n.a.createElement("div",{className:"col"},n.a.createElement("p",{className:"sub-title"},"DENOMINATOR"),n.a.createElement("p",null,c))))}}]),t}(n.a.Component);var ve=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loading:!0,error:null,data:null},a.timer=null,a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"startClock",value:function(){var e=this,t=Date.now();!function a(){e.state.prestoLoading?e.setState({queryTime:Date.now()-t},function(){e.timer=setTimeout(a,100)}):e.timer=null}()}},{key:"loadData",value:function(){var e=this,t=Object.keys(this.props.dataSources),a=new URLSearchParams(this.props.location.search);t.length&&(a.delete("ds"),t.forEach(function(t){e.props.dataSources[t].selected&&a.append("ds",t)})),this.setState({loading:!0},function(){C.request("/api/measure/result/report?".concat(a)).then(function(t){return e.setState({data:t,loading:!1})},function(t){return e.setState({error:t,loading:!1})})})}},{key:"runQuery",value:function(e){var t=this;this.setState({prestoLoading:!0,queryTime:0,query:e},function(){t.startClock(),C.query(e).then(function(e){t.setState({prestoLoading:!1,prestoError:null,prestoData:e})},function(e){t.setState({prestoLoading:!1,prestoError:e,prestoData:null})})})}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(e){if(!this.state.loading){var t=e.dataSources||{};for(var a in t){if((this.props.dataSources||{})[a].selected!==t[a].selected)return this.loadData()}}}},{key:"renderEditor",value:function(){var e=this;return this.state.data&&this.state.data.cohort_sql?n.a.createElement(ce,Object.assign({query:this.state.data.cohort_sql},this.props.ui.sqlEditor,{onHeightChange:function(t){return e.props.dispatch({type:N,payload:t})},onQuery:function(t){return e.runQuery(t)}})):null}},{key:"createSummaryRenderer",value:function(){return this.state.data?n.a.createElement(be,{clinic:"All Clinics",date:this.state.data.measureDate,measureName:this.state.data.measureName,startValue:this.state.numeratorValue,numeratorValue:this.state.data.numeratorValue,denominatorValue:this.state.data.denominatorValue,measureDescription:this.state.data.measureDescription||"No description available for this measure",numeratorDescription:this.state.data.numeratorDescription||"No description available for the numerator of this measure",denominatorDescription:this.state.data.denominatorDescription||"No description available for the denominator of this measure"}):null}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,r=t.prestoError,o=t.prestoData,i=t.prestoLoading,s=t.queryTime,l=t.query;return a?(console.error(a),n.a.createElement("b",null,a.message)):n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement(le,null),n.a.createElement("div",{className:"col-9"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 align-middle"},n.a.createElement("h3",{style:{lineHeight:"43px",margin:0}},n.a.createElement($.a,{path:"/report",exact:!0,render:function(){return"Month Report"}}),n.a.createElement($.a,{path:"/report/editor",render:function(){return"Cohort Builder"}}))),n.a.createElement("div",{className:"col-6 text-right"},n.a.createElement("div",{className:"btn-group view-toggle",role:"group"},n.a.createElement(te.a,{className:"btn btn-brand",to:{pathname:"/report",search:this.props.location.search},exact:!0},"REPORT"),n.a.createElement(te.a,{className:"btn btn-brand",to:{pathname:"/report/editor",search:this.props.location.search},exact:!0},"BUILDER")))),n.a.createElement("br",null),n.a.createElement($.a,{path:"/report",exact:!0,render:function(){return e.createSummaryRenderer()}}),n.a.createElement($.a,{path:"/report/editor",exact:!0,render:function(){return e.renderEditor()}}),s?n.a.createElement("div",{className:"float-right",style:{marginTop:"-4em",fontSize:11,color:"#999",textAlign:"right"}},"Total time: ",function(e){var t=[],a=[{label:"week",n:6048e5},{label:"day",n:864e5},{label:"hour",n:36e5},{label:"minute",n:6e4},{label:"second",n:1e3},{label:"ms",n:1}];if(a.reduce(function(e,a){var r=Math.floor(e/a.n);return r?(t.push("".concat(r," ").concat(a.label).concat(r>1&&a.n>1?"s":"")),e-r*a.n):e},e),t.length||t.push("0 ".concat(a.pop().label)),t.length>1){var r=t.pop();t[t.length-1]+=" and "+r}return t.join(", ")}(s),n.a.createElement("br",null),!i&&o?"Result rows: "+o.data.length:""):null,n.a.createElement("br",null),n.a.createElement("br",null),i?n.a.createElement("div",{className:"alert alert-info"},"Loading..."):r?n.a.createElement("div",{className:"alert alert-danger"},r.message):void 0===o?null:o&&o.data&&o.data.length?n.a.createElement(ue,{data:o,query:l}):n.a.createElement("div",{className:"alert alert-info"},"No data to display"),n.a.createElement("br",null))))}}]),t}(n.a.Component),ye=Object(p.b)(function(e){return{ui:e.ui,dataSources:e.dataSources}})(ve),ge=a(14);a(51);function Ee(e){return Object.keys(e).filter(function(t){return!!e[t]}).join(" ")}function Oe(e){e.preventDefault(),e.stopPropagation()}var je=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={open:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"toggleOption",value:function(e){this.props.multiple||this.setState({open:!1}),this.props.onSelect(e.value)}},{key:"renderOptions",value:function(){var e=this;return this.props.options.map(function(t){return n.a.createElement("div",{key:t.value,className:Ee({"dropdown-item":1,selected:t.selected}),onMouseDown:function(){return e.toggleOption(t)}},e.props.multiple&&n.a.createElement("i",{className:Ee({"fas fa-check-square":t.selected,"far fa-square":!t.selected})}),n.a.createElement("b",null,t.label),t.description&&n.a.createElement("div",{className:"small text-muted"},t.description))})}},{key:"render",value:function(){var e=this,t="None Selected",a=this.props.options.filter(function(e){return e.selected});return a.length>0&&(t=a.length===this.props.options.length?"All ".concat(this.props.label):a.map(function(e){return e.label}).join(", ")),n.a.createElement("div",{className:Ee({dropdown:1,multiple:this.props.multiple,show:this.state.open})},n.a.createElement("button",{className:"btn btn-brand dropdown-toggle",type:"button",onClick:function(){return e.setState({open:!e.state.open})},onBlur:function(){return e.setState({open:!1})}},t),n.a.createElement("div",{className:Ee({"dropdown-menu":1,show:this.state.open}),onClick:Oe,onMouseDown:Oe},this.renderOptions()))}}]),t}(n.a.Component),Ne=a(1),we=a.n(Ne),ke=a(23),Se=(a(52),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,a=t.description,r=t.name,o=t.measures,i=[],s=[],l=me()();o.forEach(function(t){var a=[],o=0,c=function(r){var s=t.data[r],c=me()(r),u=c.format("MMM");-1===i.indexOf(u)&&i.push(u);var d="".concat(c.format("MMM YYYY")," - ").concat(s.numerator," of ").concat(s.denominator),p=Math.round(s.pct),m=new URLSearchParams;if(m.set("date",c.format("YYYY-MM-DD")),m.set("measure",t.id),m.set("org",e.props.org.value),Object.keys(e.props.dataSources).forEach(function(t){e.props.dataSources[t].selected&&m.append("ds",t)}),c.isSame(l,"year"))a[o%12]=n.a.createElement("td",{key:r,title:d},n.a.createElement(ke.a,{to:"/report?".concat(m)},Math.round(p),"%"));else{var h=me()(c).add(1,"year");t.data[h]||(a[o%12]=n.a.createElement("td",{key:r,title:d},n.a.createElement(ke.a,{to:"/report?".concat(m),className:"text-muted"},Math.round(p),"%")))}o++};for(var u in t.data)c(u);s.push(n.a.createElement("tr",{key:r+"-"+t.name,className:e.props.selectedOrgId===e.props.orgId&&e.props.selectedMeasureId===t.id?"selected":"",onClick:function(a){"A"!==a.target.nodeName&&e.props.onRowClick(t)}},n.a.createElement("th",null,t.name),a))});var c=n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null),i.map(function(e,t){return n.a.createElement("th",{key:"th-"+t},e)})));return n.a.createElement("div",null,n.a.createElement("h4",null,a),n.a.createElement("div",{className:"table-responsive"},n.a.createElement("table",{className:"table table-sm table-hover timeline-grid"},c,n.a.createElement("tbody",null,s))))}}]),t}(n.a.Component));Se.defaultProps={data:{}},Se.contextTypes={router:we.a.object};var xe=Object(p.b)(function(e){return{dataSources:e.dataSources}})(Se),Me=window.Highcharts,Ce=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e='-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"';this.chart=window.Highcharts.chart("container",{chart:{type:"spline",borderWidth:1,borderColor:"#EEE",plotBackgroundColor:"#F6F6F6",plotBorderColor:"#DDD",plotBorderWidth:1,zoomType:"x"},drilldown:{allowPointDrilldown:!1,drillUpButton:{text:"This is a test",position:{x:0,y:-35},theme:{"stroke-width":2,stroke:"#4a90e2"}}},title:{align:"center",style:{fontFamily:e,fontSize:"1.5rem",fontWeight:500}},subtitle:{align:"center",style:{fontFamily:e,fontSize:"1rem",fontWeight:300}},xAxis:[{lineWidth:0,crosshair:!0,type:"category",id:"year_axis",showEmpty:!1,categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],plotLines:[{value:me()().month(),zIndex:2,color:"rgba(200, 0, 0, 0.5)",dashStyle:"ShortDash"}],title:{text:null}},{lineWidth:0,id:"monthAxis",crosshair:!0,type:"datetime",minorTicks:!0,showEmpty:!1,zoomEnabled:!0,min:+me()().utc().startOf("month"),max:+me()().utc().endOf("month").startOf("day"),dateTimeLabelFormats:{day:"%e"},title:{text:null}}],yAxis:{id:"pct_axis",title:{text:"% Patients",style:{fontFamily:e,fontSize:"1rem",fontWeight:500}},lineColor:"#CCC",tickInterval:25,min:0,max:100,lineWidth:0},tooltip:{crossHairs:!0,shared:!0,useHTML:!0,headerFormat:'<b>{point.key}</b><hr style="margin: 2px 0"/><table>',pointFormat:'<tr><td style="color: {series.color}; text-align: right">{series.name}: </td><td style="text-align: right"><b>&nbsp;{point.y} %</b></td></tr>',footerFormat:"</table>",valueDecimals:2},plotOptions:{spline:{lineWidth:3,states:{hover:{lineWidth:4}},marker:{enabled:!1}}},series:[{name:"Current Year",id:"current_year",color:"#4a90e2",type:"areaspline",xAxis:"year_axis",shadow:!0,fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,Me.color("#4a90e2").setOpacity(.35).get()],[1,Me.color("#4a90e2").setOpacity(0).get()]]},marker:{enabled:!1}},{name:"Previous Year",id:"previous_year",color:"#555",dashStyle:"ShortDot",xAxis:"year_axis",lineWidth:2}],navigation:{menuItemStyle:{fontSize:"10px"}},legend:{align:"left",verticalAlign:"top",layout:"horizontal",floating:!0,x:60,y:58}}),this.chart.update(this.props.chartOptions,!0,!0,!1)}},{key:"componentDidUpdate",value:function(){this.chart.drillUp(),this.chart.update(this.props.chartOptions,!0,!0)}},{key:"render",value:function(){return n.a.createElement("div",{id:"container",style:{width:"100%",height:240,marginBottom:15}})}}]),t}(n.a.Component),De=window.Highcharts,Ae=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={chart:{},selection:{}},a.onRowClick=a.onRowClick.bind(Object(ge.a)(Object(ge.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"loadDataIfNeeded",value:function(e){var t=this;if(this.props.loading)return!1;if(!this.props.organizations.length)return!1;if(!this.props.payers.length)return!1;if(!Object.keys(this.props.measures).length)return!1;if(!Object.keys(this.props.dataSources).length)return!1;if(!this.props.data)return this.props.dispatch(Q());if(e){for(var a in e.dataSources){var r=e.dataSources[a];if(this.props.dataSources[a].selected!==r.selected)return this.props.dispatch(Q())}var n=!0,o=!1,i=void 0;try{for(var s,l=function(){var e=s.value;if(t.props.payers.find(function(t){return t.value===e.value}).selected!==e.selected)return{v:t.props.dispatch(Q())}},c=e.payers[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var u=l();if("object"===typeof u)return u.v}}catch(y){o=!0,i=y}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}var d=!0,p=!1,m=void 0;try{for(var h,f=function(){var e=h.value;if(t.props.organizations.find(function(t){return t.value===e.value}).selected!==e.selected)return{v:t.props.dispatch(Q())}},b=e.organizations[Symbol.iterator]();!(d=(h=b.next()).done);d=!0){var v=f();if("object"===typeof v)return v.v}}catch(y){p=!0,m=y}finally{try{d||null==b.return||b.return()}finally{if(p)throw m}}}}},{key:"componentDidUpdate",value:function(e){this.loadDataIfNeeded(e)}},{key:"componentDidMount",value:function(){this.loadDataIfNeeded()}},{key:"getSelection",value:function(){var e=this.state.selection,t=e.orgId,a=e.measureId;t||(t=Object.keys(this.props.data.organizations).shift());var r,n=this.props.data.organizations[t];return r=a?n.measures.find(function(e){return e.id===a}):n.measures[0],{orgId:t,org:n,measure:r}}},{key:"getChartOptions",value:function(e,t,a){var r=[{data:[],id:"current_year",name:"Current Year",xAxis:"year_axis"},{data:[],id:"previous_year",name:"Previous Year",xAxis:"year_axis"}],n=me()().utc(),o=n.format("YYYY"),i=n.month(),s=0,l=0;Object.keys(a.data).forEach(function(e){var t=e.split("-"),n=Object(he.a)(t,2),c=n[0],u=n[1],d=a.data[e],p={x:1*u-1,y:d.pct,name:me()(e).format("MMMM"),xAxis:0};c===o?(r[0].data.push(p),1*u===i&&(s=d.pct)):1*c===o-1&&(+u-1===i&&(p.drilldown="Month_last_year",l=d.pct),r[1].data.push(p))}),r[0].data.push({x:i,y:s+6-6*Math.random(),xAxis:0,name:me()().format("MMMM"),color:"#900",drilldown:"Month"});for(var c=me()().utc().startOf("month"),u={id:"Month",name:me()().format("MMMM YYYY"),data:[],type:"areaspline",xAxis:1,color:"rgb(200, 100, 100)",shadow:!0,fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,De.color("rgb(200, 100, 100)").setOpacity(.35).get()],[1,De.color("#4a90e2").setOpacity(0).get()]]},marker:{enabled:!1}},d={name:me()().subtract(1,"year").format("MMMM YYYY"),id:"Month_last_year",xAxis:1,data:[],dashStyle:"ShortDot",color:"#555",lineWidth:2,marker:{enabled:!1}},p=l-s;c.isSameOrBefore(me()(n).endOf("month"),"day");)c.isSame(me()(n).endOf("month"),"day")?d.data.push({x:+c,y:l}):d.data.push({x:+c,y:s+p*Math.random()}),c.isSameOrBefore(n,"day")&&u.data.push({x:+c,y:s+p-2*p*Math.random()}),c.add(1,"day");return{title:{text:a.name},subtitle:{text:t.description},series:r,drilldown:{series:[u,d]}}}},{key:"onRowClick",value:function(e,t,a){this.setState({selection:{orgId:e,measureId:a.id}})}},{key:"renderStage",value:function(){var e=this,t=this.props,a=t.error,r=t.loading,o=t.data;if(r)return n.a.createElement("p",{style:{textAlign:"center"}},"Loading...");if(a)return n.a.createElement("pre",null,a.stack);if(!o)return n.a.createElement("p",{style:{textAlign:"center"}},"No data to display");var i=this.getSelection(),s=i.orgId,l=i.org,c=i.measure,u=[],d=function(t){var a=e.props.organizations.find(function(e){return e.value===t}),r=o.organizations[t];if(!a.selected)return"continue";u.push(n.a.createElement(xe,{key:"timeline-"+t,data:r,org:a,orgId:t,onRowClick:function(a){return e.onRowClick(t,r,a)},selectedOrgId:s,selectedMeasureId:c.id}))};for(var p in o.organizations)d(p);return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ce,{key:"line-chart",chartOptions:this.getChartOptions(s,l,c)}),n.a.createElement("div",{style:{maxHeight:"calc(100vh - 210px)",overflow:"auto"}},u))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"row"},n.a.createElement(le,null),n.a.createElement("div",{className:"col-9"},n.a.createElement("div",{className:"row align-items-center"},n.a.createElement("div",{className:"col"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col"},n.a.createElement("label",null,"Payer"),n.a.createElement(je,{label:"All Payers",value:null,onSelect:function(t){return e.props.dispatch(H(t))},options:this.props.payers})),n.a.createElement("div",{className:"col"},n.a.createElement("label",null,"Organization"),n.a.createElement(je,{multiple:!0,label:"Organizations",onSelect:function(t){return e.props.dispatch(function(e){return{type:I,payload:e}}(t))},options:this.props.organizations})),n.a.createElement("div",{className:"col"},n.a.createElement("label",null,"Clinic"),n.a.createElement(je,{label:"All Clinics",value:null,onSelect:function(){return 1},options:[{label:"All Clinics",description:"Show results from all clinics",value:null}]})))),n.a.createElement("div",{className:"col-3 align-self-end"},n.a.createElement("br",null),n.a.createElement("button",{className:"btn btn-brand active btn-block"},"Update"))),n.a.createElement("br",null),this.renderStage()))}}]),t}(n.a.Component),qe=Object(p.b)(function(e){return{organizations:Object.keys(e.organizations).map(function(t){return{value:t,label:e.organizations[t].name,selected:e.organizations[t].enabled,description:e.organizations[t].description}}),payers:Object.keys(e.payers).map(function(t){return{value:t,label:e.payers[t].label,selected:e.payers[t].selected}}),measures:e.measures,dataSources:e.dataSources,data:e.measureResults.data,loading:e.measureResults.loading,error:e.measureResults.error}})(Ae),Re=a(29),Ue=a.n(Re),ze=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={email:"user@aco.org",password:"password"},a.onSubmit=a.onSubmit.bind(Object(ge.a)(Object(ge.a)(a))),a.onChange=a.onChange.bind(Object(ge.a)(Object(ge.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){e.preventDefault(),this.props.login(this.state.email,this.state.password)}},{key:"onChange",value:function(e){this.setState(Object(b.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=(this.props.location.state||{from:{pathname:"/measures"}}).from;return e&&e.pathname&&"/"!==e.pathname||(e={pathname:"/measures"}),this.props.currentUser?n.a.createElement(ee.a,{to:e,push:!0}):n.a.createElement("div",{className:"row"},n.a.createElement("form",{className:"mx-auto col-xs-12 col-sm-8 col-md-6 col-lg-4",onSubmit:this.onSubmit},this.props.error&&n.a.createElement("div",{className:"alert alert-danger",role:"alert"},String(this.props.error)),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"email1"},"Email address"),n.a.createElement("input",{type:"email",className:"form-control",id:"email1",placeholder:"Enter email",name:"email",value:this.state.email,onChange:this.onChange,disabled:this.props.loading}),n.a.createElement("small",{className:"form-text text-muted"},'Enter "user@aco.org" or "user@payer.org"')),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"password1"},"Password"),n.a.createElement("input",{type:"password",className:"form-control",id:"password1",placeholder:"Password",name:"password",value:this.state.password,onChange:this.onChange,disabled:this.props.loading}),n.a.createElement("small",{className:"form-text text-muted"},'The default password is "password"')),n.a.createElement("br",null),n.a.createElement("button",{disabled:this.props.loading,type:"submit",className:"btn btn-block btn-brand active"},this.props.loading&&n.a.createElement("i",{className:"fas fa-spinner fa-spin"})," Login"),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("p",{className:"text-center"},n.a.createElement("img",{src:Ue.a,alt:"BCH Logo",width:"150"}))))}}]),t}(n.a.Component),Ie=Object(p.b)(function(e){return e.auth},function(e){return{login:function(t,a){return e(function(e,t){return function(a,r){return a(U(!0)),C.login(e,t).then(function(e){sessionStorage.currentUser=JSON.stringify(e),a(z({currentUser:e,error:null,loading:!1}))}).catch(function(e){console.error(e),a(z({error:e,loading:!1}))})}}(t,a))}}})(ze),Le=(a(53),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.component,r=Object(X.a)(e,["user","component"]);return n.a.createElement($.a,Object.assign({},r,{render:function(e){return t?n.a.createElement(a,e):n.a.createElement(ee.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}}]),t}(n.a.Component));function Ye(e){var t=Object(p.b)(function(t){return Object(v.a)({},e,{user:t.auth.currentUser})})(Le);return n.a.createElement(t,e)}var Pe=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(m.a,null,n.a.createElement("div",{className:"App"},n.a.createElement(ne,{user:this.props.user,loading:this.props.loading,dispatch:this.props.dispatch}),n.a.createElement("div",{className:"container",style:{marginTop:30}},n.a.createElement(Ye,{path:"/",component:ye,exact:!0}),n.a.createElement(Ye,{path:"/report",component:ye}),n.a.createElement(Ye,{path:"/measures",component:qe}),n.a.createElement($.a,{path:"/login",component:Ie}))))}}]),t}(n.a.Component),Te=Object(p.b)(function(e){return{user:e.auth.currentUser,loading:e.auth.loading}})(Pe),He=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(m.a,null,n.a.createElement(p.a,{store:K},n.a.createElement(Te,null)))}}]),t}(n.a.Component);i.a.render(n.a.createElement(He,null),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.b73ebde9.chunk.js.map